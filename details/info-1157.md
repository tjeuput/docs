# INFO-1157: MediaServerStarter - Dienst-Installation korrupt

## Kategorie
**Bug Fix** | MediaServerStarter

## Beschreibung

Optimierungen für die Installation als Dienst, behebt einen Fehler, bei dem installierte Dienstnamen korrupt und nicht für Windows leserlich waren.

### Problem

Bei der Installation des MediaServerStarter als Windows-Dienst traten schwerwiegende Probleme auf:
- **Dienstnamen waren korrupt**: Unleserliche Zeichen im Dienstnamen
- **Windows konnte den Dienst nicht erkennen**: Service Manager konnte den Dienst nicht verwalten
- **Verwaltung unmöglich**: Start/Stop/Neustart des Dienstes nicht möglich
- **Mehrfach-Installationen betroffen**: Besonders problematisch bei mehreren MediaServern auf einem Rechner

### Lösung

Die Dienst-Installationslogik wurde vollständig überarbeitet:
- **Korrekte Namenskodierung**: Dienstnamen werden Windows-konform generiert
- **Validierung**: Dienstnamen werden vor der Installation validiert
- **Mehrfach-Installation unterstützt**: Eindeutige Namen bei mehreren Instanzen

Zusätzlich wurde ein Feature hinzugefügt:
- **Dienstverwaltung**: Der MediaServerStarter speichert seinen Dienstnamen in der Base-Config für spätere Versionen

---

## Auswirkung

- **Komponente**: MediaServerStarter
- **Version**: 5.0.0
- **Kategorie**: Fehlerbehebung + Optimierung

---

## Technische Details

### Fix für korrupte Dienstnamen
- **Problem**: Zeichenkodierung fehlerhaft
- **Lösung**:
  - UTF-8/ASCII-konforme Namensgebung
  - Sonderzeichen-Filter
  - Windows-Service-API korrekt verwendet

### Neue Konfigurationsparameter

Der MediaServerStarter schreibt jetzt informativ und für spätere Versionen seinen Dienstnamen in die Base-Config, sofern dieser einen abweichenden Installationsnamen hat (wie z.B. bei mehreren MediaServern auf einem Rechner der Fall):

```
Server/mname = Name des Dienstes vom MediaServer
```

---

## Mehrfach-Installation

Bei mehreren MediaServern auf einem Rechner:
1. Jeder MediaServer erhält einen eindeutigen Dienstnamen
2. Der Name wird in der jeweiligen Base-Config gespeichert
3. Spätere Updates können den korrekten Dienst identifizieren und verwalten

---

## Benutzernutzen

- **Zuverlässigkeit**: MediaServer-Dienst installiert korrekt
- **Verwaltbarkeit**: Dienst kann über Windows Service Manager gesteuert werden
- **Mehrfach-Installation**: Unterstützung für mehrere MediaServer auf einem System
- **Update-Sicherheit**: Korrekte Dienst-Identifikation bei Updates
- **Transparenz**: Dienstname ist lesbar und verständlich

---

## Zugehörige Änderungen

Siehe auch:
- **[INFO-1156](./info-1156.md)**: Ähnlicher Fix für Starter.exe
- **Updater**: Unterstützt nun `/mname` Parameter für individuelle Dienstnamen
